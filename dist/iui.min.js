(function(d,c,a,f){c.IUI_UTILS={animateEnd:"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",transitionEnd:"webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd msTransitionEnd",isPlaceholder:function(){var g=a.createElement("input");return"placeholder" in g},throttle:function(h,j,n){var g,l,o;var m=null;var k=0;if(!n){n={}}var i=function(){k=n.leading===false?0:new Date().getTime();m=null;o=h.apply(g,l);if(!m){g=l=null}};return function(){var p=new Date().getTime();if(!k&&n.leading===false){k=p}var q=j-(p-k);g=this;l=arguments;if(q<=0||q>j){clearTimeout(m);m=null;k=p;o=h.apply(g,l);if(!m){g=l=null}}else{if(!m&&n.trailing!==false){m=setTimeout(i,q)}}return o}},debounce:function(i,k,h){var n,m,g,l,o;var j=function(){var p=new Date().getTime()-l;if(p<k&&p>0){n=setTimeout(j,k-p)}else{n=null;if(!h){o=i.apply(g,m);if(!n){g=m=null}}}};return function(){g=this;m=arguments;l=new Date().getTime();var p=h&&!n;if(!n){n=setTimeout(j,k)}if(p){o=i.apply(g,m);g=m=null}return o}},scrollBarWidth:(function(){var h;var g=d("<div/>");g.css({width:100,height:100,overflow:"scroll",position:"absolute",top:-9999});d("html").append(g);h=g[0].offsetWidth-g[0].clientWidth;g.remove();return h}())};c.IUI={};d.fn.IUI=function(){var g=arguments;var i=arguments[0];if(IUI[i]){i=IUI[i];g=Array.prototype.slice.call(g,1);return i.apply(this,g)}else{if(typeof(i)=="object"||!i){for(var h in i){IUI=d.extend(IUI,i);i=IUI[h];break}}else{d.error("Method "+i+" does not exist on jQuery.IUI Plugin");return this}}};var e=d({});d.extend({sub:function(){e.on.apply(e,arguments)},unsub:function(){e.off.apply(e,arguments)},pub:function(){e.trigger.apply(e,arguments)}});d.extend({alert:function(q){var i=IUI_UTILS.scrollBarWidth();var k=d("body");var n=a.all&&!c.atob?0:200;var j={title:"",content:"",confirmText:"确定",cancelText:"取消",closeBtn:false,shadow:true,type:"confirm",status:"default",keyboard:true,before:function(){},confirm:function(){},cancel:function(){}};var h=d.extend({},j,q);var g=l();var p={showAlert:function(){o(g)},hideAlert:function(){m(g)},target:g};if(!d.alertBackdrop){d.alertBackdrop=d('<div class="IUI-alert-backdrop" style="display:none"></div>');k.append(d.alertBackdrop)}if(h.shadow){k.on("touchstart.iui-alert click.iui-alert",".IUI-alert-container",function(r){r.preventDefault();m(g)})}k.on("touchstart.iui-alert click.iui-alert",".IUI-alert-main",function(r){r.stopPropagation()});g.on("touchstart.iui-alert click.iui-alert",".IUI-alert-confirm",function(r){if(h.type==="alert"){if(h.cancel.call(this,p)===false){return false}m(g);return false}if(h.confirm.call(this,p)===false){return false}});g.on("touchstart.iui-alert click.iui-alert",".IUI-alert-cancel,.IUI-alert-close",function(r){if(h.cancel.call(this,p)===false){return false}m(g)});if(h.keyboard){if(h.keyboard){d(c).on("keyup.iui-alert",function(r){if(r.keyCode===27){g.find(".IUI-alert-cancel,.IUI-alert-close").trigger("click.iui-alert")}if(r.keyCode===13){g.find(".IUI-alert-confirm").trigger("click.iui-alert")}})}}function o(r){k.css({"border-right":i+"px transparent solid",overflow:"hidden"});r.removeClass("hide");r.find(".IUI-alert-main").addClass("alert-opening");d.alertBackdrop.removeClass("hide").fadeIn(n,function(){r.find(".IUI-alert-main").removeClass("alert-opening")})}function m(r){d([k,r]).off("touchstart.iui-alert click.iui-alert");r.addClass("alert-closing");d.alertBackdrop.fadeOut(n,function(){d(this).addClass("hide");r.remove();k.removeAttr("style")})}function l(){var u=h.type==="confirm";var x='<span class="IUI-alert-close"></span>';var t='<a href="javascript:;" class="IUI-alert-confirm">'+h.confirmText+"</a>";var w='<a href="javascript:;" class="IUI-alert-cancel">'+h.cancelText+"</a>";var z='<div class="IUI-alert-header">'+(h.title||"")+(h.closeBtn?x:"")+"</div>";var v='<div class="IUI-alert-content">'+(h.content||"")+"</div>";var s='<div class="IUI-alert-footer">'+t+(u?w:"")+"</div>";var r=z+v+s;var y=d('<div class="IUI-alert-container hide"><div class="IUI-alert-main '+h.status+'">'+r+"</div></div>");k[0].appendChild(y[0]);return y}if(h.before.call(this,p)===false){return false}o(g)}});
/*!
     * JavaScript Cookie v2.1.2
     * https://github.com/js-cookie/js-cookie
     *
     * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
     * Released under the MIT license
     */
(function(g){function i(){var m=0;var j={};for(;m<arguments.length;m++){var k=arguments[m];for(var l in k){j[l]=k[l]}}return j}function h(k){function j(t,s,p){var w;if(typeof a==="undefined"){return}if(arguments.length>1){p=i({path:"/"},j.defaults,p);if(typeof p.expires==="number"){var n=new Date();n.setMilliseconds(n.getMilliseconds()+p.expires*86400000);p.expires=n}try{w=JSON.stringify(s);if(/^[\{\[]/.test(w)){s=w}}catch(r){}if(!k.write){s=encodeURIComponent(String(s)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)}else{s=k.write(s,t)}t=encodeURIComponent(String(t));t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);t=t.replace(/[\(\)]/g,escape);return(a.cookie=[t,"=",s,p.expires&&"; expires="+p.expires.toUTCString(),p.path&&"; path="+p.path,p.domain&&"; domain="+p.domain,p.secure?"; secure":""].join(""))}if(!t){w={}}var v=a.cookie?a.cookie.split("; "):[];var u=/(%[0-9A-Z]{2})+/g;var q=0;for(;q<v.length;q++){var o=v[q].split("=");var m=o.slice(1).join("=");if(m.charAt(0)==='"'){m=m.slice(1,-1)}try{var l=o[0].replace(u,decodeURIComponent);m=k.read?k.read(m,l):k(m,l)||m.replace(u,decodeURIComponent);if(this.json){try{m=JSON.parse(m)}catch(r){}}if(t===l){w=m;break}if(!t){w[l]=m}}catch(r){}}return w}j.set=j;j.get=function(l){return j(l)};j.getJSON=function(){return j.apply({json:true},[].slice.call(arguments))};j.defaults={};j.remove=function(m,l){j(m,"",i(l,{expires:-1}))};j.withConverter=h;return j}g.extend({cookie:h(function(){})})}(jQuery));d.loading=d.fn.loading=function(h,i){var k={display:false,type:"css",animateHtml:'<div class="ball-clip-rotate"><div></div></div>',src:"http://img.yi114.com/201571121314_382.gif",shadow:true};var g=this instanceof d?this:d("body");var j='<div class="IUI-loading">';if(typeof h==="object"){d.extend(k,h)}else{if(h!==f){k.display=h}if(i!==f){k.type=i}}if(k.type==="css"){j+="{{animateHtml}}</div>".replace("{{animateHtml}}",k.animateHtml)}else{j+='<img src="{{src}}" ></div>'.replace("{{src}}",k.src)}if(k.display){if(k.shadow){j='<div class="IUI-loading-backdrop"></div>'+j}g.append(j)}else{g.find(">.IUI-loading-backdrop,>.IUI-loading").remove()}};d.extend({tip:function(s){var h=d.extend({container:"body",obj:"#message",text:"",timeout:1000,status:true,offset:false,callback:null},s);var r=h.obj.charAt(0)==="#"?"id":"class";var j=d(h.obj).length===0?d("<div "+r+'="'+h.obj.slice(1)+'" />').appendTo("body"):d(h.obj);var i=h.status?"success":"error";var k=j.data("count")||1;var g=new Date().getTime();var o=j.outerWidth();var q=j.outerHeight();var n=j.offset().left;var m=j.offset().top;var p;clearTimeout(j.data("count"));if(h.offset){if(typeof j.attr("data-tip")==="undefined"){d('<div class="tip-part" id="tip_'+g+'" style="left:'+(n+h.offset[0])+"px;top:"+(m+q+h.offset[1])+'px"></div>').appendTo(h.container);j.attr("data-tip",g)}p=d("#tip_"+j.attr("data-tip"))}var l=h.offset?p:j;l.html('<span class="'+i+'">'+h.text+"</span>").removeClass("hide");j.data("count",setTimeout(function(){l.addClass("hide");if(h.callback){h.callback()}},h.timeout))}});(function(l,i){var k=IUI_UTILS.scrollBarWidth;var g=l('<div class="layer-backdrop" style="display:none"></div>');var n=a.documentElement.clientHeight;var j=l("body");var h=a.all&&!i.atob?0:200;function m(p,o){var q={container:"body",vertical:true,cache:false,shadow:true,confirmHandle:".btn-confirm",closeHandle:".btn-cancel,.btn-close",offsetWidth:"auto",offsetHeight:"auto",url:l(this).attr("data-url")||false,dataType:l(this).attr("data-dataType")||"html",content:"",showCall:function(){},hideCall:function(){},successCall:function(){},errorCall:function(){},confirmCall:function(){},cancelCall:function(){}};this.$selector=o;this.config=l.extend(q,p);this.$backdrop=g;this.init();this.event()}m.prototype.init=function(){var w=this;var r=w.config;var t='<div class="layer-box hide" id="{layerName}"><div class="layer-content">'+r.content+"</div></div>";var u=this.$selector=w.$selector.length?w.$selector:l(t.replace("{layerName}",w.$selector.selector.replace("#",""))).appendTo(r.container);var v=r.container==="body"?j:l(r.container);var q=r.closeHandle;var o=this.$content=u.find(".layer-content");var p=Number(u.attr("data-width"))||r.offsetWidth;var s=Number(u.attr("data-height"))||r.offsetHeight;o.css({width:p,height:s})};m.prototype.ajaxLoad=function(){var p=this;var q=p.config;var s=p.$selector;var r=q.url||"?";var t=s.attr("data-method")||"GET";var o=q.dataType;if(q.cache&&s.data("success")){p.showLayer();return false}l.loading(true,true);s.data("success",1);l.ajax({url:r,type:t,dataType:o,data:q.data}).then(function(u){l.loading(false);q.successCall.apply(s,[u,this,p]);p.showLayer()},function(u){l.loading(false);p.hideLayer();q.errorCall.apply(s,[u,this,p])});return p};m.prototype.event=function(){var o=this;var p=o.config;var q=o.$selector;q.on("click.iui-layer",p.confirmHandle,function(r){r.preventDefault();p.confirmCall.apply(q,[r,this]);return false});q.on("click.iui-layer",function(r){if(!p.shadow){return false}if(j.find(".layer-loading").length){return false}o.hideLayer();p.cancelCall.apply(q,[r,this]);return false});q.on("click.iui-layer",".layer-content",function(r){r.stopPropagation()});q.on("click.iui-layer",p.closeHandle,function(r){o.hideLayer();p.cancelCall.apply(q,[r,this]);return false})};m.prototype.showLayer=function(){var o=this;var p=o.config;j.css({"border-right":k+"px transparent solid",overflow:"hidden"});o.$selector.removeClass("hide");o.$selector.after(g);o.$content.addClass("layer-opening");g.fadeIn(h,function(){o.$content.removeClass("layer-opening")});j.addClass("layer-open");o.$selector.trigger("layer.show",[o]);p.showCall.apply(o.$selector,[o]);return o};m.prototype.hideLayer=function(){var o=this;var p=o.config;o.$content.addClass("layer-closing");o.$backdrop.fadeOut(h,function(){o.$selector.addClass("hide");o.$content.removeClass("layer-closing");l(this).remove()});j.removeClass("layer-open").removeAttr("style");o.$selector.trigger("layer.hide",[this]);p.hideCall.apply(o.$selector,[o]);return o};l.fn.IUI({layer:function(o){return new m(o,this)}})}(jQuery,c));d.fn.IUI({returnTop:function(j){var k={target:".returnTop-btn",showTop:100,bottom:50,delay:300};var m=d(this);var l=d(c);var i=d.extend({},k,j);var g=m.find(i.target);var h=function(o,n){if(n>i.showTop&&o.hasClass("hide")){o.removeClass("hide")}if(n<i.showTop&&!o.hasClass("hide")){o.addClass("hide")}return false};h(g,l.scrollTop());m.css({bottom:i.bottom});l.on("scroll",function(n){h(g,d(c).scrollTop())});m.on("click",i.target,function(n){d("body,html").stop().animate({scrollTop:0},i.delay);return false})}});d.fn.IUI({tab:function(g){return this.each(function(){var l={item:".tab-item",content:".tab-content",current:"active",handle:"click",afterShow:function(){},beforeShow:function(){}};var n=d(this);var i=d.extend({},l,g);var o=n.find(i.item);var j=n.find(i.content);var k=null;var h=0;if(!o.length){return}m(o.eq(0));n.on(i.handle,i.item,function(p){p.preventDefault();var q=d(this);i.beforeShow.apply(q,[p,i]);m(q);i.afterShow.apply(q,[p,i])});function m(r,p){var q=n.find(i.item);_contents=n.find(i.content);h=q.index(r);q.removeClass(i.current);_contents.removeClass(i.current);q.eq(h).addClass(i.current);_contents.eq(h).addClass(i.current)}})}});d.extend({share:function(p){var i=d.extend({title:null,summary:null,url:null,pic:d("body").find("img").eq(0).attr("src"),copybtn:"#copy-url",swbbtn:".sweibo",qzonebtn:".qzone",twbbtn:".tweibo",dbbtn:".douban",rrbtn:".renren"},p);var n=encodeURIComponent(i.title);var m=encodeURIComponent(i.summary);var j=encodeURIComponent(a.domain+i.pic);var h=encodeURIComponent(i.url+"&share=weibo");h="http://service.weibo.com/share/share.php?url="+h+"&title="+n+"&pic="+j+"&appkey=&searchPic=false";d(i.swbbtn).attr("href",h);var g=encodeURIComponent(i.url+"&share=qzone");g="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+g+"#qzone&title="+n+"&summary="+m+"&pics="+j;d(i.qzonebtn).attr("href",g);var k=encodeURIComponent(i.url+"&share=tweibo");k="http://share.v.t.qq.com/index.php?c=share&a=index&url="+k+"#tweibo&appkey=appkey&title="+m+"&pic="+j;d(i.twbbtn).attr("href",k);var o=encodeURIComponent(i.url+"&share=douban");o="http://www.douban.com/share/service?image="+j+"&href="+o+"#douban&name="+n+"&text="+m;d(i.dbbtn).attr("href",o);var l=encodeURIComponent(i.url+"&share=renren");l="http://widget.renren.com/dialog/share?resourceUrl="+l+"&srcUrl="+l+"&title="+n+"&pic="+j+"&description="+m;d(i.rrbtn).attr("href",l);d(i.copybtn).val(i.url+"&share=copy")}});d.extend({exist:function(o){var j=d.extend({obj:d("body"),parents:".form-container",type:"email",success:null},o);var m=j.obj instanceof d?j.obj:d(j.obj);var k=m.find("#"+j.type).parents(j.parents);var h=m.find('input[name="activityId"]').val();var l=m.find("#"+j.type).val();var g=d('meta[name="csrf-param"]').prop("content");var i=d('meta[name="csrf-token"]').prop("content");var n=l?"&email="+l:"";d.post("/index/init-activity",g+"="+i+"&activityId="+h+n,function(p){if(p.status){if(l){if(p.register){k.find("#"+j.type).val("");k.removeClass("none")}else{k.addClass("none")}}if(j.success){j.success(p.region)}}})}});d.extend({ajaxError:function(i){var l=this;var k=[];var n=d.extend({obj:"#message",data:null,timeout:3000,status:true},i);var j=n.obj instanceof d?n.obj:d(n.obj);var h=n.status?"success":"error";var m="";if(n.data.error.constructor!==Object){console.log("验证已经全部通过，不再执行往下方法");return false}d.each(l.find(".val-error"),function(o,s){var r=d(s).attr("name");var p=d(s).attr("data-name");var q=p?p:r;k.push(q)});if(k){d.each(k,function(o,p){d.each(n.data.error,function(q,r){if(p===q){m=r;return m}});if(m){g(m);return false}})}function g(p){var o=j.data("count")||1;clearTimeout(j.data("count"));j.html('<span class="'+h+'">'+p+"</span>").removeClass("hide none");j.data("count",setTimeout(function(){j.addClass("none")},n.timeout))}}});d.fn.IUI({ajaxForm:function(g){return this.each(function(){var k=d(this);var j={url:k.attr("action"),method:k.attr("method")||"POST",type:k.attr("data-type")||"json",data:k.attr("data-ajaxType")||"ajax",before:function(){},success:function(){},error:function(){},pending:function(){},always:function(){}};var i=k.find("input");var h=d.extend({},j,g);k.data("deferred",h);k.on("submit",function(m){m.preventDefault();if(k.hasClass("disabled")){h.pending.call(k,h);return false}var n=h.before.call(k,m,h);var l={url:h.url,type:h.method,data:k.serialize()};if(h.data!=="ajax"){l.data=new FormData(k[0]);l.cache=false;l.contentType=false;l.processData=false}if(n===false){return false}k.addClass("disabled").prop("disabled",true);d.ajax(l).then(function(o){k.removeClass("disabled").prop("disabled",false);h.success.call(k,o,h)},function(o){k.removeClass("disabled").prop("disabled",false);h.error.call(k,o,h)}).always(function(o){h.always.call(k,o,h)})})})}});d.fn.IUI({validate:function(i){var h={isNonEmpty:function(o){var m=this.self;var n=m[0].value;if(d.trim(n).length===0){return false}},minLength:function(m){if(this.self[0].value.length<m.minLength){return false}},maxLength:function(m){if(this.self[0].value.length<m.maxLength){return false}},birthdayRange:function(p){var o=this.self[0].value;var n=p.range[0];var m=p.range[1];if(o<n||o>m){return false}},isBirthday:function(m){if(!/^[1-9]\d{3}([-|\/|\.])?((0\d)|([1-9])|(1[0-2]))\1(([0|1|2]\d)|([1-9])|3[0-1])$/.test(this.self[0].value)){return false}},isMobile:function(m){if(!/^1[3|4|5|6|7|8][0-9]\d{8}$/.test(this.self[0].value)){return false}},isEmail:function(m){if(!/(^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$)/.test(this.self[0].value)){return false}},between:function(q){var n=this.self;var p=this.self[0].value.length;var o=q.range[0];var m=q.range[1];if(p<o||p>m){return false}},onlyEn:function(m){if(!/^[A-Za-z]+$/.test(this.self[0].value)){return false}},onlyZh:function(m){if(!/^[\u4e00-\u9fa5]+$/.test(this.self[0].value)){return false}},notInt:function(m){if(/^[0-9]*$/.test(this.self[0].value)){return false}},onlyNum:function(m){if(!/^[0-9]+([.][0-9]+){0,1}$/.test(value)){return false}},onlyInt:function(m){if(!/^[0-9]*$/.test(value)){return false}},isChecked:function(n){var m=void (0);this.self.each(function(o,p){m=p.checked;return m?false:true});return m?void (0):false},isNickname:function(m){if(!/^[A-Za-z0-9_\-\u4e00-\u9fa5]{2,20}$/i.test(this.self[0].value)){return false}}};var k={ajaxValidate:false,globalMessage:false,errorClass:".validate-error",infoClass:".validate-info",successClass:".validate-success",collections:null,strategy:h};var g=this;function l(m){this.container="body";this.options=d.extend(true,{},k,m);this.$selector=g;this.cache={};this.init();this.behavior()}l.prototype.init=function(){var m=this;var o=m.options.collections;var p=["info","success","error"];for(var n=0;n<o.length;n++){var q=m.$selector.find('[data-required="'+o[n].required+'"]');var r='iui-validate:cannot find element by data-required="'+o[n].required+'"';if(q.length){m.add(o[n])}else{if(c.console){console.warn(r)}else{throw r}}}d.each(m.cache,function(u,s){if(s.context.length===0){return}var v=/validate-context-(info|success|error)/.exec(s.context[0].className);var t;if(v){t=v[1];s.self.data("validateStatus",d.inArray(t,p))}})};l.prototype.add=function(o){var m=this.$selector.find("[data-required="+o.required+"]");var n=m.parents(o.context).eq(0);d.extend(true,this.cache,(function(){var p={};var q=p[o.required]={};q.matches={};q.self=m;q.context=n;q.infoMsg=o.infoMsg||"";q.options=o;d.extend(true,q.matches,o.matches);return p}()))};l.prototype.behavior=function(){var m=this;var n=j.call(this);this.$selector.on("focus",n,function(q){var r=d(this);var o=r.data("required");var p=m.cache[o];if(m.options.infoClass){m.message(0,p)}r.trigger("validate.focus",p)});this.$selector.on("blur",n,function(o){var q=d(this);var p=q.data("required");if(m.cache[p].options.unblur){return false}m.verify.call(this,m,"blur")});this.$selector.on("change",'input[type=radio][data-required],input[type=checkbox][data-required],input[type="file"][data-required]',function(o){m.verify.call(this,m,"change")})};l.prototype.verify=function(r,n){var q=d(this);var o=r.cache[q.data("required")];var p=o.matches;var m=false;d.each(p,function(t,u){var s=r.options.strategy[t].call(o,u);m=s===void (0)?1:2;q.data("validateStatus",s);r.message(m,o,t);return m===2?false:true});q.trigger("validate."+n,o);return m};l.prototype.message=function(p,q,o){var r,t,s,n,m;t=["info","success","error"];m=this.options.globalMessage?d(this.options.globalMessage):q.context;if(p===0){r=this.options.infoClass;s=q.infoMsg}else{if(p===1){r=this.options.successClass;s=""}else{if(p===2){r=this.options.errorClass;s=q.matches[o].errMsg}else{}}}r=r.replace(/\./g," ").slice(1);m.removeClass("validate-context-info validate-context-success validate-context-error").addClass("validate-context-"+t[p]).find(".validate-message").remove();n=d('<div class="validate-message '+r+'" >'+s+"</div>");m.append(n)};l.prototype.batch=function(o){var n=this;var m=[];d.each(this.cache,function(r,s){if(s.self[0].disabled){return}var q=s.self.data("validateStatus");var p=!q?n.verify.call(s.self,n,"batch"):q;if(o&&p===2){m.push(p);return false}m.push(p)});return d.inArray(2,m)===-1?true:false};function j(){var q="";var o=this.options.collections;for(var n=0;n<o.length;n++){var m=o[n].required;var p=this.cache[m];if(p&&/checkbox|radio|file/.test(p.self[0].type)){continue}q+="[data-required="+o[n].required+"],"}return q.slice(0,q.length-1)}return new l(i)}});d.fn.IUI({tooltip:function(i){var k={target:"[data-tooltip]",animateClass:"fadeIn",event:"hover",template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-body"></div></div>'};var h=d.extend(k,i);var j=h.event==="hover"?"mouseenter":"click";var g=h.event==="hover"?"mouseleave":"click";return this.each(function(m,n){var o=h.target;var l=h.animateClass;d(n).on(j,o,function(){d(".tooltip").remove();var y=d(this);var r=this;var D=r.getBoundingClientRect();var A=D.left;var v=D.top;var w=r.offsetWidth;var q=r.offsetHeight;var B=y.attr("data-direction")||"top",p=y.attr("data-distance")*1||5,C=y.attr("data-title");var u=y.after(d(h.template)).next(".tooltip").addClass(B+" "+l);u.find(".tooltip-body").text(C);var x=u[0].offsetWidth;var t=u[0].offsetHeight;var s,z;if(B=="top"){s=A+(w-x)/2;z=v-t-p}else{if(B=="right"){s=A+w+p;z=v+(q-t)/2}else{if(B=="bottom"){s=A+(w-x)/2;z=v+q+p}else{if(B=="left"){s=A-x-p;z=v+(q-t)/2}}}}u.css({top:z,left:s});return false});if(h.event==="hover"){d(n).on(g,o,function(){d(this).next(".tooltip").remove()})}else{d(a).on(g,function(p){d(".tooltip").remove()})}})}});d.fn.IUI({emailSuffix:function(g){return this.each(function(){var k={container:"body",style:"global",item:"email-item",current:"checked",emails:["163.com","126.com","qq.com","gmail.com","sina.com","139.com","189.com","sohu.com"],delay:300,offsetLeft:d(this).offset().left,offsetTop:d(this).offset().top,offsetWidth:d(this).outerWidth(),offsetHeight:d(this).outerHeight(),checkedCall:function(){}};var p=d(this);var i=d.extend({},k,g);var m=d('<ul class="email-list hide"></ul>');var l=d(i.container);var j=null;var n=function(q,r){var x="";var w=r.value||null;var u=w?w.split("@")[0]:false;var v=w?w.split("@")[1]:false;for(var t=0,s;s<q.length;t++){if((u&&!v)||v&&s.indexOf(v)!==-1){x+='<li class="'+i.item+'" data-value="'+u+"@"+s+'">'+u+"@"+s+"</li>"}}return x};var o=function(x,w,v){var t=[38,40];if(d.inArray(x,t)===-1||w.hasClass("hide")){return false}var u=d.inArray(x,t)>=1?true:false;var r=w;var q=r.find("li").length;var s=r.find("li.checked");r.find("li").removeClass("checked");if(u){if(s.length&&s.index()!==q-1){s.next().addClass("checked")}else{r.find("li").eq(0).addClass("checked")}}else{if(s.index()>0){s.prev().addClass("checked")}else{r.find("li").eq(q-1).addClass("checked")}}v.val(d.trim(r.find("li.checked").text()));i.checkedCall.apply(p,[event,i])};var h=function(){var s=i.offsetLeft;var r=i.offsetTop;var q=i.offsetWidth;m.css({left:s,top:r+i.offsetHeight,width:q})};h();if(i.style==="global"){l.append(m);d(c).on("resize.emailSuffix",h)}else{p.parent().append(m)}p.on("keyup.emailSuffix",function(q){var s=this.value;if(s.charAt(0)!=="@"&&s.split("@").length===2&&d.inArray(q.keyCode,[40,38,13])===-1){var r=n(i.emails,this);m.html(r).removeClass("hide").find("li").eq(0).addClass("checked")}else{if(d.inArray(q.keyCode,[40,38,13])===-1){m.html("").addClass("hide")}}});p.on("keydown.emailSuffix",function(r){var q=m.find("li.checked");o(r.keyCode,m,p);if(r.keyCode===13){r.preventDefault();if(q.length){p.val(d.trim(q.text()))}m.addClass("hide")}});p.on("blur.emailSuffix",function(q){j=setTimeout(function(){m.addClass("hide")},i.delay)});m.on("click",i.item,function(q){q.preventDefault();clearTimeout(j);p.val(d(this).attr("data-value")).focus();m.addClass("hide");i.checkedCall.apply(p,[q,i]);return false})})}});d.fn.IUI({placeholder:function(g){if("placeholder" in a.createElement("input")){return}var i={color:"#999",zIndex:2};var j=d.extend({},i,g||{});var h=d(this).find('input[type="text"],input[type="password"],input[type="tel"],input[type="email"]');return h.each(function(l,q){var p=d(q),m=q,o=p.attr("placeholder"),k=d("<label></label>").css({position:"absolute",top:0,left:0,height:0,lineHeight:p.css("height"),fontSize:p.css("fontSize"),paddingLeft:p.css("textIndent")?p.css("textIndent"):p.css("paddingLeft"),background:"none",cursor:"text",color:j.color,zIndex:j.zIndex}).text(o).insertBefore(p);p.parent().css({position:"relative"});if(p.val()){k.hide()}k.bind({click:function(){k.hide();p.focus()}});p.bind({focus:function(){k.hide()},blur:function(){if(!p.val()){k.show()}},input:function(){if(p.val()){k.hide()}else{k.show()}}});m.onpropertychange=function(n){n=n||c.event;if(n.propertyName=="value"){var r=d(this);if(r.val()){d(this).prev("label").hide()}else{d(this).prev("label").show()}}}})}});d.fn.IUI({fadeSlide:function(g){return this.each(function(){var n=d(this),k=d.extend({interval:5000},g),m=null,l=0,h=n.find("ul");if(h.find("li").length<=1){return false}n.append(j(h.find("li").length,"●"));h.find("li").eq(0).addClass("current");n.on({mouseenter:function(o){n.find(".ficon").removeClass("none")},mouseleave:function(o){n.find(".ficon").addClass("none")}});n.find(".next").on("click",function(p){p.preventDefault();var o=n.find("ol li");if(!n.data("animate")){n.data("animate",1);if(l<o.length-1){l++}else{l=0}o.removeClass("current");o.eq(l).addClass("current");h.find("li").fadeOut(500).eq(l).fadeIn(500,function(){n.data("animate",0)});h.find("li").eq(l).addClass("current").siblings(".current").removeClass("current")}});n.find(".prev").on("click",function(p){p.preventDefault();var o=n.find("ol li");if(!n.data("animate")){n.data("animate",1);if(l>0){l--}else{l=o.length-1}o.removeClass("current");o.eq(l).addClass("current");h.find("li").fadeOut(500).eq(l).fadeIn(500,function(){n.data("animate",0)});h.find("li").eq(l).addClass("current").siblings(".current").removeClass("current")}});n.on({mouseenter:function(o){clearTimeout(m)},mouseleave:function(o){m=setTimeout(i,k.interval)}},".prev,.next");n.find("ol").on({mouseenter:function(o){clearTimeout(m);l=d(this).index();if(d(this).hasClass("current")){return false}d(this).addClass("current").siblings(".current").removeClass("current");h.find("li").fadeOut(500).eq(l).fadeIn(500);h.find("li").eq(l).addClass("current").siblings(".current").removeClass("current")},mouseleave:function(o){m=setTimeout(i,k.interval)}},"li");m=setTimeout(i,k.interval);function i(){clearTimeout(m);var o=n.find("ol li");if(l<o.length-1){l++}else{l=0}o.removeClass("current");o.eq(l).addClass("current");h.find("li").fadeOut(500).eq(l).fadeIn(500);h.find("li").eq(l).addClass("current").siblings(".current").removeClass("current");m=setTimeout(i,k.interval)}function j(o,t){var q,p=o,s="",r=t||"&nbsp;";s+="<ol>";for(q=0;q<p;q++){if(q===0){s+='<li class="current">'+r+"</li>"}else{s+="<li>"+r+"</li>"}}s+="</ol>";return s}})}});d.fn.IUI({typeCount:function(g){return this.each(function(){d(this).on("keyup","input[type=text],textarea",function(k){k.preventDefault();var l=d(this);var h=l.parent().find("span.count");var i=parseInt(h.text().split("/")[1]);var j=this.value.length;if(j>i){h.addClass("error")}else{h.removeClass("error")}h.html(j+"/"+i)});d(this).find("input,textarea").trigger("keyup")})}});d.fn.IUI({lrselect:function(s){var k={level:1,dataJson:"",afterMoveLeft:function(){},afterMoveRight:function(){}};var q=this;var p;var m={self:{ele:".lrselect",contraryEle:".lrselect-to"},to:{ele:".lrselect-to",contraryEle:".lrselect"}};var j={self:{ele:".lrselect .level-2",contraryEle:".lrselect-to .level-2"},to:{ele:".lrselect-to .level-2",contraryEle:".lrselect .level-2"}};q.$container=d(this);q.$multi=q.$container.find(".lrselect");q.$multiTo=q.$container.find(".lrselect-to");q.config=d.extend({},k,s);d(c).on("keydown.win",function(t){t.preventDefault();switch(t.which){case 17:case 91:q.$container.data("type","mul");break;case 16:q.$container.data("type","continu");break}});d(c).on("keyup.win",function(t){t.preventDefault();q.$container.data("type","")});var g=function(v,u,t){this.execute=v;this.value=u;this.dire=t};var n=function(){var t=[];var u=[];return{execute:function(v){v.execute();t.push(v);p.setValue(v.dire)},undo:function(){if(!t[0]){return false}var v=t.pop();u.push(v);p.undo(v.value,v.dire);p.setValue(v.dire)},redo:function(){if(!u[0]){return false}var v=u.pop();t.push(v);p.redo(v.value,v.dire);p.setValue(v.dire)}}};function i(){this.calculator=new n();this.init()}i.prototype={init:function(){q.mulData=q.config.level>=2?j:m;this.render(q.config.dataJson);this.setCommandFn();this.events();this.operateEvent()},render:function(u){var t=h(u);q.$multi.append(t.item);q.$container.find("select").css("display","none").append(t.option);if(q.config.level>=2){q.mulData=j;q.$multiTo.append(q.$multi.children().clone());q.$multiTo.find(".level-2 li").remove();q.$container.on("click",".mul-title",function(){d(this).toggleClass("active").parent("li").find(".level-2").toggleClass("hide")})}},setCommandFn:function(){var t=this;q.setCommand=function(v,u){var w=t.getId(v);t.calculator.execute(u(w))};q.moveTo=function(){o("to")};q.move=function(){o("self")};q.moveToAll=function(){o("to","all")};q.moveAll=function(){o("self","all")};q.moveToTitle=function(){o("to","title")};q.moveTitle=function(){o("self","title")};q.toCommand=function(u){return new g(q.moveTo,u,"to")};q.selfCommand=function(u){return new g(q.move,u,"self")};q.allToCommand=function(u){return new g(q.moveToAll,u,"to")};q.allSelfCommand=function(u){return new g(q.moveAll,u,"self")};q.titleToCommand=function(u){return new g(q.moveToTitle,u,"to")};q.titleSelfCommand=function(u){return new g(q.moveTitle,u,"self")}},events:function(){var v=this;var u=q.mulData.self.ele+" li";var t=q.mulData.to.ele+" li";q.$container.on("click",u,function(w){v.itemClick(d(this),"self")});q.$container.on("click",t,function(w){v.itemClick(d(this),"to")});q.$container.on("dblclick",u,function(w){var x=d(this);q.setCommand(x,q.selfCommand)});q.$container.on("dblclick",t,function(w){var x=d(this);q.setCommand(x,q.toCommand)});if(q.config.level>=2){q.$multi.on("dblclick",".mul-title",function(w){v.moveTitle(d(this))});q.$multiTo.on("dblclick",".mul-title",function(w){v.moveToTitle(d(this))})}},operateEvent:function(){var t=this;if(!q.$container.find(".lrselect-right").length){return}q.$container.on("click",".lrselect-right",function(){t.move()});q.$container.on("click",".lrselect-left",function(){t.moveTo()});q.$container.on("click",".lrselect-rightAll",function(){t.moveAll()});q.$container.on("click",".lrselect-leftAll",function(){t.moveToAll()});q.$container.on("click",".lrselect-undo",function(){t.calculator.undo()});q.$container.on("click",".lrselect-redo",function(){t.calculator.redo()})},itemClick:function(E,C){var A=q.$container.data("type");var y=E.parent("ul");var D=y.find("li");var B=q.mulData[C].ele+" li";if(A=="mul"){E.toggleClass("current");return}if(A=="continu"){var x=y.find("li.current").eq(0);var t=D.index(x);var z=D.index(E);var u=z>t?t:z;var v=z<t?t:z;if(t<0){E.addClass("current");return}D.removeClass("current");for(var w=u;w<=v;w++){D.eq(w).addClass("current")}return}q.$container.find(B).removeClass("current");E.addClass("current")},getId:function(t){var v=[];var u=t;d.each(u,function(w,x){v.push(d(x).data("id"))});v=v.join(",");return v},moveTo:function(){var t=q.$multiTo.find("li.current");q.setCommand(t,q.toCommand)},move:function(){var t=q.$multi.find("li.current");q.setCommand(t,q.selfCommand)},moveToAll:function(){var t=q.$multiTo.find("li");q.setCommand(t,q.allToCommand)},moveAll:function(){var t=q.$multi.find("li");q.setCommand(t,q.allSelfCommand)},moveToTitle:function(t){var u=t.parent("li").find(".level-2 li");t.addClass("current");q.setCommand(u,q.titleToCommand)},moveTitle:function(t){var u=t.parent("li").find(".level-2 li");t.addClass("current");q.setCommand(u,q.titleSelfCommand)},undo:function(w,t){var x=q.$container.find(q.mulData[t].contraryEle);var y=q.$container.find(q.mulData[t].ele);var A=w.split(",");var v=[];for(var u=0;u<A.length;u++){var z=x.find('li[data-id="'+A[u]+'"]');v.push(z)}if(q.config.level>=2){l(v,y);return}y.append(v);r(y)},redo:function(w,t){var x=q.$container.find(q.mulData[t].ele);var y=q.$container.find(q.mulData[t].contraryEle);var A=w.split(",");var v=[];for(var u=0;u<A.length;u++){var z=x.find('li[data-id="'+A[u]+'"]');v.push(z)}if(q.config.level>=2){l(v,y);return}y.append(v);r(y)},setValue:function(t){var v=q.$container.find(q.mulData.to.ele+" li");var u=[];q.$container.find("select option").prop("selected",false);d.each(v,function(w,x){q.$container.find('select option[value="'+d(x).data("value")+'"]').prop("selected",true)});switch(t){case"to":q.config.afterMoveLeft();break;case"self":q.config.afterMoveRight();break}}};p=new i();function h(w){var y="";var x="";var z="";if(q.config.level===1){for(var v=0;v<w.length;v++){y+='<li data-id="'+(v+1)+'" data-value="'+w[v].value+'">'+w[v].name+"</li>";z+='<option data-id="'+(v+1)+'" value="'+w[v].value+'">'+w[v].name+"</option>"}}if(q.config.level===2){for(var t=0;t<w.length;t++){x="";for(var u=0;u<w[t].child.length;u++){x+='<li data-id="'+((t+1)*10+(u+1))+'" data-value="'+w[t].child[u].value+'">'+w[t].child[u].name+"</li>";z+='<option data-id="'+((t+1)*10+(u+1))+'" value="'+w[t].child[u].value+'">'+w[t].child[u].name+"</option>"}y+='<li data-id="'+(t+1)+'"><div class="mul-title">'+w[t].name+'</div><ul class="level-2">'+x+"</ul></li>"}}return{option:z,item:y}}function r(y){var t=y.find("li");var x=[];var w=[];var A;for(var v=0;v<t.length;v++){var z=t.eq(v).data("id");x.push(z)}Array.prototype.sort.call(x,function(B,C){return B-C});for(var u=0;u<x.length;u++){A=y.find('li[data-id="'+x[u]+'"]');w.push(A)}y.html("").append(w)}function l(t,u){d.each(t,function(v,w){w=w instanceof d?w:d(w);var y=w.data("id");var x=Math.floor(y/10)-1;u.eq(x).append(w)});d.each(u,function(v,w){r(d(w))})}function o(t,u){var x=q.$container.find(q.mulData[t].ele+" li.current");var w=q.$container.find(q.mulData[t].ele+" li");var v=q.$container.find(q.mulData[t].contraryEle);if(u==="all"){x=w}if(u==="title"){x=d(".mul-title.current").parent("li").find(".level-2 li");d(".mul-title").removeClass("current")}if(q.config.level>=2){l(x,v);return}v.append(x);r(v)}return{moveRight:function(t){t.addClass("current");q.setCommand(t,q.selfCommand)},moveLeft:function(t){t.addClass("current");q.setCommand(t,q.toCommand)},moveRightAll:function(){var t=q.$multi.find("li");q.setCommand(t,q.allSelfCommand)},moveLeftAll:function(){var t=q.$multiTo.find("li");q.setCommand(t,q.allToCommand)},updateJson:function(t,u){q.$multi.html("");q.$multiTo.html("");q.$container.find("select").html("");p.calculator=new n();if(u&&u!=q.config.level){q.config.level=Math.min(2,u);q.mulData=q.config.level>=2?j:m}p.render(t);p.events()}}}});(function(j,h,g,k){function i(l,m){this.options=j.extend({},i.defaults,m);this.$container=j(this.options.container);this.$selector=j(l);this.init();this.event()}i.defaults={dataJson:null,container:"body",template:'<div class="selector-level selector-level-{{level}}"><a href="javascript:;" role="name" class="selector-name selector-name-dcolor" data-caller="{{caller}}">{{name}}</a><input type="hidden" name="{{field}}" role="input" value=""><ul role="content" class="selector-list hide">{{content}}</ul></div>',placeholder:["请选择省份","请选择市","请选择区"],field:["userProvinceId","userCityId","userAreaId"],iselect:false,isvalue:true,shorthand:false,values:[],level:1,joinHtml:function(q,r,l,v){var m=q;var t=m.length;var s=r||"100000";var n=this.options.iselect?"<option>"+v+"</option>":"";if(l<0){return n}for(var p=0;p<t;p++){var u=this.options.shorthand?m[p].shortName:m[p].name;var o=this.options.isvalue?m[p].id:m[p].name;if(m[p].parentId===s){if(this.options.iselect){n+='<option data-item="'+l+'" value="'+o+'">'+u+"</option>"}else{n+='<li data-item="'+l+'" data-id="'+m[p].id+'" data-value="'+o+'">'+u+"</li>"}}}return n},startClick:null};i.prototype.init=function(){var l=this;var m=l.options;var o,q,p;for(var n=0;n<m.level;n++){q=m.placeholder[n]||"";o=m.template.replace("{{level}}",n+1).replace("{{caller}}",n+1);if(!n){o=o.replace("{{content}}",m.joinHtml.call(this,m.dataJson,null,n+1,q))}else{o=o.replace("{{content}}",m.joinHtml.call(this,m.dataJson,null,-1,q))}if(o.indexOf("{{name}}")!==-1){o=o.replace("{{name}}",q)}if(o.indexOf("{{field}}")!==-1){p=m.field[n]||"";o=o.replace("{{field}}",p)}l.$selector.append(o)}};i.prototype.event=function(){var l=this;var m=l.options;var p=l.$selector;for(var n=0;n<m.level;n++){(o)(n)}if(!m.iselect){j(g).on("click.iselector",function(r){var s=r||h.event;var q=s.target||s.srcElement;while(q){if(q.className&&q.className.indexOf(l)>-1){return}q=q.parentNode}l.$selector.find('[role="content"]').addClass("hide")})}function o(r){var q=n+1;if(m.iselect){p.on("change.iselector",'[data-caller="'+q+'"]',function(s){var t=j(this);l.hideSelector(t,r,true)})}else{p.on("click.iselector",'[data-caller="'+q+'"]',function(t){var u=j(this);var s=p.find('[role="content"]');s.addClass("hide").eq(r).removeClass("hide");if(typeof m.startClick==="function"){m.startClick.apply(this,[l,u,m])}return false});p.on("click.iselector",'[data-item="'+q+'"]',function(s){var t=j(this);m.values=[];l.hideSelector(t,r,false)})}}};i.prototype.hideSelector=function(r,s,t){var z=this;var n=z.options;var y=z.$selector;var x=y.find('[role="name"]');var v=y.find("[data-caller]");var u=y.find('[role="input"]');var l=y.find('[role="content"]');var q=t?r.val():r.attr("data-id");var o=r.text();var m=s+1;var p=s+2;var w=n.placeholder[m]||"";if(t){w=n.placeholder[m]||"";l.eq(m).html(n.joinHtml.call(z,n.dataJson,q,p,w));l.eq(m).find("[data-item]").eq(0).prop("selected",true).trigger("change")}else{r.addClass("checked").siblings(".checked").removeClass("checked");x.eq(s).text(o).removeClass("selector-name-dcolor");u.eq(s).val(q);l.eq(m).html(n.joinHtml.call(z,n.dataJson,q,p,w));l.eq(m).find("[data-item]").eq(0).trigger("click");l.eq(s).addClass("hide")}n.values.unshift(q);y.trigger("choose-"+m,[z,r,m,n.values])};j.fn.IUI({iselector:function(l){return this.each(function(){if(!j(this).data("iselector")){j(this).data("iselector",new i(this,l))}})}})})(jQuery,c,a);(function(i){var h={readOnly:false,contain:".tokenize",remove:"",maxLength:20,overLimitCount:function(){},existToken:function(){},searchCallback:function(){}};var g={top:38,right:39,bottom:40,left:37,enter:13,back:9};var k={spanTemplate:['<span class="token-item">','<span>{text}</span><span data-value="{value}" class="token-close">x</span>',"</span>"].join(""),optionTemplate:'<option selected="selected" value="{value}">{value}</option>',liTemplate:'<li class="hidden" data-value="{value}">{value}</li>',inputTemplate:'<div class="token"> <span> <input type="text" maxlength="{{maxlength}}" style="width: {{width}}px"> </span> </div>'};var j=i.fn.tokenize=function(l){var m=i.extend({},h,l);k.inputTemplate=k.inputTemplate.replace("{{maxlength}}",m.maxLength).replace("{{width}}",m.maxLength*16);this.each(function(n,o){var q=i(this);var p=q.attr("data-limitCount")*1;if(typeof p!=="number"||isNaN(p)){p=Infinity}q.data({showAll:q.attr("data-showAll")==="false"?false:true,create:q.attr("data-create")==="false"?false:true,limitCount:p});q.append(k.inputTemplate);j.renderSelect(q);j.setEvent(q,m);q.find("li[uled]").each(function(r,s){i(s).addClass("current "+m.remove).trigger("click")});q.find(".tokenize-level").removeClass("hide")})};j.renderSelect=function(l){var m=l.find("select").prop("outerHTML");m=(m+"").replace(/<optgroup\s+label="(.*)".*>/g,'<li class="tokenize-level">$1<ul class="tokenize-menu">');m=m.replace(/<\/optgroup>/g,"</ul></li>");m=m.replace(/select/g,"ul").replace(/option/g,"li").replace(/value/g,"data-value");l.append(m)};j.createToken=function(q,m,o){var n=i(this).parents(o.contain).find("input").val("");var l=n.parent();var p=k.spanTemplate.replace("{text}",q).replace("{value}",m);i(p).insertBefore(l)};j.setEvent=function(l,m){if(m.readOnly===false){l.on("click",".token-close",function(o){o.stopPropagation();var q=i(this);var n=q.parents(m.contain);var p=q.attr("data-value");var r=n.find('li[data-value="'+p+'"]');if(r.hasClass("no-remove")){return}n.find('option[value="'+p+'"]').removeAttr("selected");r.removeClass("hidden");r.parents("li").eq(0).removeClass("hide");q.parent(".token-item").remove();j.hideToken(n)});l.on("click",".token",function(n){n.stopPropagation();var o=i(this);o.find("input").focus();j.searchToken.call(o.find("input")[0],m)});l.on("keyup","input",function(p){var n=p.keyCode;var o=g;if(n!==o.enter&&n!==o.back&&n!==o.bottom&&n!==o.top){j.searchToken.call(this,m)}});l.on("keyup",">ul,input",function(p){var n=p.keyCode;var o=g;if(n===o.enter||n===o.back){j.setToken.call(this,m)}});l.on("keyup",function(p){var n=p.keyCode;var o=g;if(n===o.bottom||n===o.top){j.turnToken.call(this,n)}});l.on("mouseenter","li",function(n){if(!i(this).hasClass("tokenize-level")){var o=i(this);o.parents(m.contain).find("li").removeClass("current");o.addClass("current")}})}else{l.find("input").attr("readonly","readonly")}l.on("click","li",function(n){if(!i(this).hasClass("tokenize-level")){j.setToken.call(this,m)}else{n.stopPropagation()}})};j.searchToken=function(q){var n=i(this).parents(q.contain);var o=n.find(">ul").removeClass("hide").find("li").not(".tokenize-level").removeClass("current").not(".hidden");var m=n.data("showAll");var l=i.trim(this.value);var p=0;o.each(function(s,u){var t=i(u);var r=t.text();var v=p!==0?"":"current";if((m||l!=="")&&r.indexOf(l)>-1){++p;t.removeClass("hide").addClass(v)}else{t.addClass("hide")}});q.searchCallback.call(n);j.hideTitle.call(n)};j.setToken=function(o){var l=i(this).parents(o.contain);var m=l.find("li").not(".tokenize-level");var r=m.filter(".current");var s;var q;var n=l.find(".token input");var t=i.trim(n.val());if(!j.testCount.call(this,o)){o.overLimitCount(l);return}if(!j.testExist.call(this,o)){o.existToken(l);return}if(r.length){r.removeClass("current").addClass("hidden");j.createToken.call(this,r.text(),r.attr("data-value"),o);q=m.index(r);l.find("option").eq(q).attr("selected","selected");j.hideTitle.call(l)}else{var p=l.find("ul");if(l.data("create")&&p.length===1&&t){l.find("ul").append(k.liTemplate.replace(/\{value\}/g,t));j.createToken.call(this,t,t,o);l.find("select").append(k.optionTemplate.replace(/\{value\}/g,t))}}j.hideToken(l)};j.turnToken=function(m){var l=i(this).find("li").not(".tokenize-level");var o=l.filter(":visible");var n=o.filter(".current");var p=o.index(n);var q=o.length;if(q){p=m===40?(p+1)%q:(p!==-1?p-1:p)%q;n.removeClass("current");o.eq(p).addClass("current")}};j.hideToken=function(l){i(a).click(function(m){j.hideToken(i(".tokenize"))});return function(m){m.find(">ul").addClass("hide");m.find("li").not(".tokenize-level").addClass("hide")}}();j.hideTitle=function(){var l=this.find(".tokenize-level");l.each(function(m,o){var n=i(o);if(n.find("li:not(.hidden):not(.hide)").length>0){n.removeClass("hide")}else{n.addClass("hide")}})};j.testCount=function(o){var l=i(this).parents(o.contain);var n=l.data("limitCount");var m=l.find(".token-item").length;if(n!==Infinity){if(m>=n){return false}}return true};j.testExist=function(o){var n=i(this).parents(o.contain);var p=i.trim(n.find(".token input").val());var m=n.find(".token-item");var l=true;m.each(function(r,s){var q=i(s).find("span").eq(0);if(q.text()===p){l=false;return}});return l};i.fn.IUI({tokenize:j})})(jQuery);d.fn.IUI({hideNavbar:function(v){var q=this;var r=d(".navbar");var t=r.outerHeight()/2;var m=this.hasClass("hide-navbar-on-scroll");var i,l,u,j,p,k,h,s,n;if(!m&&!r.length){return false}i=l=Math.abs(q.scrollTop());n=IUI_UTILS.throttle(o,100);q.on("scroll",n);function o(w){l=q.scrollTop();u=this.scrollHeight;j=this.offsetHeight;h=r.hasClass("navbar-hidden");s=i<=l;i=l;if(l<t||i>l){g(false);return false}g(s);return false}function g(w){if(w){if(r.hasClass("navbar-hidden")){return false}r.addClass("navbar-hidden")}else{if(!r.hasClass("navbar-hidden")){return false}r.removeClass("navbar-hidden")}}}});d.fn.IUI({panel:function(q){var p=this;var k=d("body");var o=d('<div class="panel-overlay hide"></div>');var n=p.data("target")?d(p.data("target")):d(".panel").eq(0);var l,g;var j={delay:300};var i=d.extend({},j,q);if(p.find(".panel-overlay").length){o=d(".panel-overlay")}else{p.append(o)}if(!p.hasClass("panel-viewport")){p=d(".panel-viewport")}p.on("touchstart.IUI-panel click.IUI-panel",".panel-open",function(r){r.preventDefault();h(d(this))});p.on("touchstart.IUI-panel click.IUI-panel",".panel-overlay",function(r){r.preventDefault();m()});p.on(IUI_UTILS.transitionEnd,function(r){r.preventDefault();if(!p.hasClass("panel-move")){n.addClass("hide")}});function h(r){var s=r;l="panel-"+s.attr("data-direction");g=d("."+l);o.removeClass("hide");p.addClass(l+" panel-move");n.removeClass("hide")}function m(){p.removeClass("panel-left panel-move");o.addClass("hide")}}});function b(g,m){var j=g,h,k=this;function l(i){if(i.target!==this){return}m.call(this,i);for(h=0;h<j.length;h++){k.off(j[h],l)}}if(m){for(h=0;h<j.length;h++){k.on(j[h],l)}}}d.fn.animationEnd=function(g){b.call(this,["webkitAnimationEnd","animationend"],g);return this};d.fn.transitionEnd=function(g){b.call(this,["webkitTransitionEnd","transitionend"],g);return this};d.fn.IUI({mPicker:function(w){var k={display:"bottom",shadow:false,level:1,rows:4,Linkage:false,dataJson:"",height:36,idDefault:false,splitStr:" ",isshort:false,header:'<div class="mPicker-header"></div>',footer:'<div class="mPicker-footer"><a href="javascript:;" class="mPicker-confirm">确定</a><a href="javascript:;" class="mPicker-cancel">取消</a></div>',confirm:function(){},cancel:function(){}};var u=this;u.$container=d(this);u.$container.data("mPicker",u);u.options=d.extend({},k,w);var q=["100%","50%"];var m=d("body");m.on("touchmove",function(x){if(u.lock){x.preventDefault();x.stopPropagation()}});m.on({touchstart:function(x){x.preventDefault();u.lock=1},touchmove:function(x){x.preventDefault();clearTimeout(u.timeTouchend);u.timeTouchend=setTimeout(function(){u.lock=0},100)},touchend:function(x){x.preventDefault();u.lock=0}},".mPicker-main");u.$container.on("click",function(x){x.preventDefault();x.stopPropagation();u.render();u.$container.focus();u.$container.blur();u.$mPicker.removeClass("hide");u.$mask.removeClass("hide");clearTimeout(m.data("mPicker-timer"));m.data("mPicker-timer",setTimeout(function(){u.$main.removeClass("down")},10));if(!u.noFirst&&u.options.idDefault){p()}var y=[];u.$list.each(function(A,B){l(u.$container,0);var z=u.$container.data("id"+(A+1))?u.$container.data("id"+(A+1)):0;y.push(z)});t(y);u.event()});u.render=function(){var y;var B=[];var z;u.$container.data("middleRowIndex",parseInt(u.options.rows/2.5));if(d(".mPicker").length===0){m.append('<div class="mPicker hide"><div class="mPicker-mask hide"></div>')}u.$mPicker=m.find(".mPicker");u.disy=u.options.display==="bottom"?"mPicker-bottom down":"mPicker-modal";B.push(u.options.dataJson);if(u.options.level===2){var x=i(u.options.dataJson[0]);B.push(x)}y=v(B);z='<div class="mPicker-main '+u.disy+'" data-pickerId="'+u.pickerId+'">'+u.options.header+'<div class="mPicker-content">'+y+'</div><div class="mPicker-shadow"></div>'+u.options.footer+"</div>";u.$mPicker.append(z);u.$mask=d(".mPicker-mask");u.$main=u.$mPicker.find(".mPicker-main");u.$content=u.$main.find(".mPicker-content");u.$list=u.$main.find(".mPicker-list");u.$listul=u.$list.find("ul");if(u.options.level>1){u.$list.width(q[u.options.level-1])}u.$itemOne=u.$listul.eq(0);if(u.options.level===2){u.$itemTwo=u.$listul.eq(1)}u.$list.append('<div class="mPicker-active-box"></div>');u.$list.find(".mPicker-active-box").height(u.options.height);var A=u.options.rows%2===0?-u.options.height-2+"px":-u.options.height*0.5-2+"px";u.$content.find(".mPicker-active-box").css({"margin-top":A});u.$content.height(u.options.height*u.options.rows);u.$list.height(u.options.height*u.options.rows)};u.event=function(){u.$main.find(".mPicker-confirm").on("touchstart.confirm click.confirm",function(A){A.preventDefault();var B="";u.noFirst=true;d.each(u.$listul,function(D,F){var C=d(F).find(".active");var E=D===0?"":u.options.splitStr;if(C.length>0){D=D+1;u.$container.data("value"+D,C.data("value"));u.$container.data("id"+D,C.data("id"));B+=E+C.text()}});u.$container.val(B);u.deffered.hide(u.options.confirm)});u.$main.find(".mPicker-cancel").on("touchstart.cancel click.cancel",function(A){A.preventDefault();u.deffered.hide(u.options.cancel)});u.$mask.off("touchstart.mask click.mask").on("touchstart.mask click.mask",function(A){A.preventDefault();if(u.options.shadow){u.deffered.hide(u.options.cancel)}});var y;var x;var z;u.$list.on("touchstart.list",function(A){n(A);var C=d(this).find("ul");var B=s(C);y=A.touches[0].pageY-B;r(0,C)});u.$list.on("touchmove.list",function(D){D.preventDefault();n(D);var F;var E=d(this).find("ul");var B=E.height();var G=u.options.height*u.options.rows;var A=G-B-parseInt(u.options.rows/2)*u.options.height;var C=u.$container.data("middleRowIndex")*u.options.height;x=D.touches[0].pageY;z=x-y;F=Math.round(z);F=F>C?C:F;F=F<A?A:F;l(E,F);clearTimeout(u.timeTouchend);u.timeTouchend=setTimeout(function(){h(E)},100)});u.$list.on("touchend.list",function(A){A.preventDefault();var B=d(this).find("ul");h(B)})};function h(A){clearTimeout(u.timeTouchend);var y=o(A);var x=y.target.data("id");var z=u.$listul.index(A);if(u.options.Linkage&&z===0){g(x)}r(400,A)}function p(){var A=u.$container.val().split(u.options.splitStr);var z=[];var y=[];var B;var x;var C=function(E,D){d.each(E,function(F,G){if(G.name==A[D]){z[D]=F;y[D]=G.value;u.$container.data("value"+(D+1),y[D]);u.$container.data("id"+(D+1),z[D]);return false}})};if(typeof(A)!=="object"||!A.length||!u.$main){return}C(u.options.dataJson,0);B=u.options.Linkage?u.options.dataJson[z[0]]:u.options.dataJson[0];if(u.options.Linkage&&u.options.level===2&&z[0]&&A.length>1){x=1}if(!u.options.Linkage&&u.options.level===2&&A.length>1){x=1}if(x){B=i(B);C(B,1)}}function o(B,C){var x;var D=Math.round((s(B)/u.options.height));var z=typeof(C)==="number"?B.find("li").index(B.find('li[data-id="'+C+'"]')):u.$container.data("middleRowIndex")-D;var A=-u.options.height*(z-u.$container.data("middleRowIndex"));l(B,A);B.find("li").eq(z).addClass("active").siblings("li").removeClass("active");x={target:B.find("li").eq(z),index:z};return x}function g(x){var y=i(u.options.dataJson[x]);if(u.options.level===2){var z=j(y);u.$itemTwo.html(z);o(u.$itemTwo,0)}}function t(x){var z=x[0]?x[0]:0;var y=x[1]?x[1]:0;if(u.options.Linkage){g(z)}o(u.$itemOne,z);if(u.options.level===2){o(u.$itemTwo,y)}}function i(y){if(!y){return[]}var x=({}).hasOwnProperty.call(y,"child")?y.child:[];return x}function j(x){var y="";d.each(x,function(A,B){var z=u.options.isshort?B.shortName:B.name;y+='<li data-value="'+B.value+'" data-id="'+A+'">'+z+"</li>"});return y}function v(A){var z="";for(var y=0;y<A.length;y++){var x=j(A[y]);z+='<div class="mPicker-list"><ul>'+x+"</ul></div>"}return z}function r(y,x){x.css({"-webkit-transition-duration":y+"ms","transition-duration":y+"ms"})}function n(x){if(!x.touches){x.touches=x.originalEvent.touches}}function l(x,z){x.css({"-webkit-transform":"translateY("+z+"px)",transform:"translateY("+z+"px)"})}function s(z){var y=/\.*translateY\((.*)px\)/i;var x;if(z[0].style.WebkitTransform){x=parseInt(y.exec(z[0].style.WebkitTransform)[1])}else{if(z[0].style.transform){x=parseInt(y.exec(z[0].style.transforms)[1])}}return x}u.deffered={container:u.$container,show:function(){u.$container.trigger("touchstart")},hide:function(x){u.$mask.addClass("hide");if(u.options.display==="bottom"){u.$main.addClass("down").transitionEnd(function(){u.$mPicker.addClass("hide");u.$main.remove();if(typeof(x)==="function"){x.call(this)}});return false}u.$mPicker.addClass("hide");u.$main.remove();if(typeof(x)==="function"){x.call(this)}},updateData:function(y){if(!y.length){return}u.noFirst=false;for(var x=0;x<u.options.level;x++){u.$container.data("id"+(x+1),0);u.$container.data("value"+(x+1),"")}u.options.dataJson=y;u.$main.remove()}};return u.deffered}})}(jQuery,window,document,undefined));